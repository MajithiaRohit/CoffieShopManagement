@using System.Data


@{
    ViewData["Title"] = "Product List";
}

<div class="container mt-4">
    <!-- Success or Error Message Section -->
    @if (TempData["errorEx"] != null)
    {
        <div class="alert alert-danger mb-3 mt-3" role="alert" id="popupMessage">
            @TempData["errorEx"]
        </div>
    }

    @if (@TempData["ProductID"] == null)
    {
        if (TempData["SuccessMessageAdd"] != null)
        {
            <div class="alert alert-success mb-3 mt-3" role="alert" id="popupMessage">
                @TempData["SuccessMessageAdd"]
            </div>
        }
    }
    else
    {
        if (TempData["SuccessMessageEdit"] != null)
        {
            <div class="alert alert-success mb-3 mt-3" role="alert" id="popupMessage">
                @TempData["SuccessMessageEdit"]
            </div>
        }
    }
    @if (TempData["SuccessMessageDelete"] != null)
    {
        <div class="alert alert-success mb-3 mt-3" role="alert" id="popupMessage">
            @TempData["SuccessMessageDelete"]
        </div>
    }


    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Product List</h5>
            <a class="btn btn-outline-success mb-3" asp-controller="Product" asp-action="AddEditProduct">Add Product +</a>
            <!-- Table with stripped rows -->
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Code</th>
                        <th scope="col">Price</th>
                        <th scope="col">Description</th>
                        <th scope="col">User Name</th>
                        <th scope="col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (DataRow data in Model.Rows)
                    {
                        <tr>
                            <td>@data["ProductName"]</td>
                            <td>#@data["ProductCode"]</td>
                            <td>₹@data["ProductPrice"]</td>
                            <td>@data["Description"]</td>
                            <td>@data["UserName"]</td>
                            <td>
                                <form asp-action="AddEditProduct" asp-controller="Product" method="post" class="d-inline">
                                    <input type="hidden" name="ProductID" value="@data["ProductID"]" />
                                    <button type="submit" class="btn btn-outline-primary">Edit</button>
                                </form>
                                <form asp-action="DeleteProduct" asp-controller="Product" method="post" class="d-inline">
                                    <input type="hidden" name="ProductID" value="@data["ProductID"]" />
                                    <button type="submit" class="btn btn-outline-danger" onclick="return confirm('Are you sure you want to delete this Product?');">Delete</button>
                                </form>
                            </td>
                        </tr>
                    }
                    @if (Model.Rows.Count == 0)
                    {
                        <tr>
                            <td colspan="6" class="text-center">No products available.</td>
                        </tr>
                    }
                </tbody>
            </table>
            <!-- End Table with stripped rows -->
        </div>
    </div>
</div>

<script>
    setTimeout(function () {
        var message = document.getElementById("popupMessage");
        if (message) {
            message.style.display = "none";
        }
    }, 5000); // Hide after 5 seconds
</script>
